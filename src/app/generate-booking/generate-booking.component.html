<!-- Encabezado del formulario -->
<h2 class="header-title">ANDALUSIAN ROOMS LOCKER</h2>

<div *ngIf="bookingMsg" id="bookingMsg">
  <p>{{ bookingMsg }}</p>
</div>

<form #form="ngForm" (ngSubmit)="onSubmit(form)">
  <!-- Campo de nombre -->
  <div>
    <label for="name">Nombre</label>
    <input type="text" id="name" name="name" ngModel required placeholder="Ingresa tu nombre">
    <div *ngIf="form.controls['name']?.invalid && form.controls['name']?.touched" class="error">
      El nombre es obligatorio.
    </div>
  </div>

  <!-- Campo de tel√©fono -->
  <div>
    <label for="phone">Tel√©fono</label>
    <input type="tel" id="phone" name="phone" pattern="^[0-9]{9}$" ngModel required #phone="ngModel" placeholder="Ingresa tu tel√©fono">
    <div *ngIf="phone.invalid && phone.touched" class="error">
      <div *ngIf="phone.errors?.['required']">
        El tel√©fono es obligatorio.
      </div>
      <div *ngIf="phone.errors?.['pattern']">
        El tel√©fono debe tener exactamente 9 d√≠gitos num√©ricos.
      </div>
    </div>
  </div>

  <!-- Campo de email -->
  <div>
    <label for="email">Email</label>
    <input type="email" id="email" name="email" ngModel required email #email="ngModel" placeholder="Ingresa tu email">
    <div *ngIf="email.invalid && email.touched" class="error">
      <div *ngIf="email.errors?.['required']">
        El email es obligatorio.
      </div>
      <div *ngIf="email.errors?.['email']">
        El email debe ser v√°lido.
      </div>
    </div>
  </div>
  <div>
    <label>Tama√±o de taquilla</label>
    <div class="locker-sizes">
    <!-- Opci√≥n L -->
    <button type="button"
            [disabled]="!availableSizes.includes('L')"
            [class.selected]="selectedSize === 'L'"
            (click)="selectedSize = 'L'">
      <span class="icon">üß≥</span>
      <span class="letter">L</span>
    </button>

    <!-- Opci√≥n XL -->
    <button type="button"
            [disabled]="!availableSizes.includes('XL')"
            [class.selected]="selectedSize === 'XL'"
            (click)="selectedSize = 'XL'"
            class="large-icon">
      <span class="icon">üß≥</span>
      <span class="letter">XL</span>
    </button>
  </div>
  <div *ngIf="!selectedSize && form.submitted" class="error">
      Debes seleccionar un tama√±o de taquilla.
    </div>
  </div>
  <!-- Campo de fecha l√≠mite -->
  <div>
  <label for="expiration">Fecha recogida equipaje</label>
    <input type="date" 
          id="expiration" 
          name="expiration" 
          ngModel 
          required 
          #expiration="ngModel" 
          [min]="minDate" 
          (change)="calculatePrice()"
          [disabled]="!selectedSize"> <!-- üîπ Bloqueado hasta elegir taquilla -->
    <div *ngIf="expiration.invalid && expiration.touched" class="error">
      La fecha es obligatoria.
    </div>
  </div>

  <!-- Selector de m√©todo de pago -->
  <div>
    <label for="paymentMethod">M√©todo de pago</label>
    <select id="paymentMethod" name="paymentMethod" ngModel required>
      <option value="">Seleccione un m√©todo de pago</option>
      <option value="creditCard">Pago con tarjeta de cr√©dito</option>
    </select>
  </div>

  <!-- Muestra el precio calculado -->
  <div *ngIf="totalPrice !== null">
    <label for="price">Precio</label>
    <p id="price">‚Ç¨ {{ totalPrice }}</p>
  </div>

  <!-- Bot√≥n de Enviar -->
  <button class="enviar" type="submit" 
        [disabled]="form.invalid || isLoading || !selectedSize">
        <ng-container *ngIf="!isLoading">Reservar</ng-container>
        <ng-container *ngIf="isLoading">
          <span class="spinner"></span> Procesando...
        </ng-container>
  </button>
</form>
